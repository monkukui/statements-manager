<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>Problem Statement</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css"
        integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"
        integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ"
        crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js"
        integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            renderMathInElement(
                document.body, {
                    delimiters: [
                        { left: "$$", right: "$$", display: true },
                        { left: "$", right: "$", display: false }],
                    ignoredTags: [],
                })
        });
    </script>
  </head>
  <body>
    <h2>H: Traditional Company</h2>
<h3>問題</h3>
<p>あなたは Z 社の労働環境委員会の一員である。この役職たるもの、社員の出退勤時間や人間関係のモニタリングは欠かせないものだ。</p>
<p>Z 社には $N$ 人の社員がいる。それぞれの社員は $1$ から $N$ までの整数で番号付けられており、整数が小さいほど社員として新しいことを表す。社員が違えば仕事効率は十人十色だ。長時間の勤務もものともしない人もいれば、残業が嫌いな人や、そもそも仕事が苦手な人だっているのだ。具体的には、$i$ 番目の社員がすでに $t$ 単位時間働いているとき、単位時間 $\left[ t, t+1 \right)$ の間の仕事効率 $c_{i, t}$ は以下のように定められる。なお、$a_i \geq b_i$ が全ての $i$ について成立すると仮定してよい。</p>
<p>$c_{i, t} = \begin{cases} a_i &amp; t &lt; p_i \\ b_i &amp; \text{otherwise} \end{cases}$</p>
<p>ここで、$i$ 番目の社員の出勤時間を $s_i$、退勤時間を $e_i$ とおこう ($s_i \leq e_i$)。$i$ 番目の社員の仕事量 $w_i$ は $w_i = \sum_{t=0}^{e_i-s_i-1} c_{i, t}$ と計算される。勤怠管理システムの都合上、それぞれの社員について出勤・退勤の単位時間 $s_i, e_i$ は ''整数'' でなければならないため、例えば $2.5$ 単位時間勤務したり、時刻 $3.5$ に出勤するなどは認められていない。また、勤務時間 $e_i - s_i$ は ''$1$ 単位時間以上'' 必要なので注意しなければならない。</p>
<p>当然といえば当然なのだが、この社内には仲が良い者同士もいれば悪い者同士もいるし、そのどちらの関係でもない社員の組もある。仲が良い者同士なら一緒に仕事をする時間が欲しいものだが、仲が悪い者同士なら一緒に仕事をしたいとは思わないだろう。具体的には、社員 $i, j$ $(i \neq j)$ について仲が良い者同士である場合、$1$ 単位時間以上は必ず同時に仕事をしなければならない。また、社員 $i, j$ $(i \neq j)$ について仲が悪い者同士である場合、同時に仕事をする時間が $1$ 単位時間以上発生しないようにしなければならない。どちらでもない場合に関しては制限はない。例えば社員 $1$ の勤務時間が $[s_1, e_1) = [3, 5)$、社員 $2$ の勤務時間が $[s_2, e_2) = [5, 9)$ であるとき、同時に仕事をした時間が $1$ 単位時間未満であるため、この 2 人が仲が良い者同士である場合はこのような勤務時間帯は採用できない。仲が悪い者同士、あるいはどちらでもない場合はこのような勤務時間帯を採用することができる。</p>
<p>また、Z 社は伝統的精神を重んじているため、社員として新しいほど早めに出勤しなければならないルールが確立されている。具体的には、任意の社員の組 $i, j$ $(i &lt; j)$ について、$s_i \leq s_j$ でなければならない。退勤時刻まで同様の制約をつけると長時間労働の原因となるため、退勤時刻に関しては制限はない。</p>
<p>さて、労働環境委員会の一員であるあなたの仕事は、会社全体の仕事量、つまり $\sum_{i} w_i$ を一定以上の水準に保ちつつオフィスの開放時間 $T$ をできるだけ短くすることである。オフィスの開放時間 $T$ は、$\max_{i} e_i - \min_{j} s_j$ で定義される。</p>
<h3>入力形式</h3>
<p>以下の形式で与えられる。</p>
<pre><code>$N$ $M$ $X$
$a_1$ $b_1$ $p_1$
$a_2$ $b_2$ $p_2$
...
$a_N$ $b_N$ $p_N$
$u_1$ $v_1$ $f_1$
$u_2$ $v_2$ $f_2$
...
$u_M$ $v_M$ $f_M$
</code></pre>

<p>$1$ 行目の $N$ は Z 社の社員数を表し、$M$ は仲が良い、または仲が悪い人間関係の総数を表す。また、$X$ は会社全体の仕事量の下限を表す。つまり、会社全体の仕事量は $X$ 以上でなければならない。</p>
<p>$2$ 行目以降 $N$ 行はそれぞれの社員に関する情報を表す。$a_i, b_i$ は問題文中で説明されたように、$i$ 番目の社員の仕事効率に関する値を表し、$p_i$ は $i$ 番目の社員の仕事効率が切り替わる時間を表す。</p>
<p>$2+N$ 行目以降 $M$ 行は人間関係を表す。$u_i, v_i$ は、$i$ 番目の人間関係が社員 $u_i, v_i$ に関するものであることを表し、$f_i = 1$ であるときは「$u_i, v_i$ は仲が良い者同士である」ことを、$f_i = -1$ であるときは「$u_i, v_i$ は仲が悪い者同士である」ことを表す。なお、この $M$ 個の人間関係で明示されなかった社員の組に関しては、仲が良くも悪くもないと仮定してよい。</p>
<h3>制約</h3>
<ul>
<li>入力はすべて整数で与えられる</li>
<li>$1 \leq N \leq 200$</li>
<li>$0 \leq M \leq 200$</li>
<li>$1 \leq X \leq 10^6$</li>
<li>$0 \leq |a_i|, |b_i| \leq 10^2$</li>
<li>$1 \leq p_i \leq 10^6$</li>
<li>$a_i \geq b_i$</li>
<li>$1 \leq u_i &lt; v_i \leq N$</li>
<li>$(u_i, v_i) \neq (u_j, v_j)$ $(i \neq j)$</li>
<li>$f_i \in \left\{ -1, 1 \right\}$</li>
</ul>
<h3>出力形式</h3>
<p>人間関係による制約を満たしつつ、会社全体の仕事量を $X$ 以上にできない場合、<code>-1</code> を出力せよ。そうでない場合、会社全体の仕事量を $X$ 以上にするときのオフィスの開放時間の最小値を出力せよ。</p>
<h3>入力例 1</h3>
<p><pre>
3 1 100
5 3 5
2 -1 9
2 1 5
1 2 -1
</pre></p>
<h3>出力例 1</h3>
<p><pre>
29
</pre></p>
<p>例えば以下のようにすれば達成可能である。</p>
<ul>
<li>社員 $1$ が時刻 $0 $ で出勤、時刻 $20 $ で退勤 (仕事量 $5 \times 5 + 3 \times 15 = 70$)</li>
<li>社員 $2$ が時刻 $20 $ で出勤、時刻 $29 $ で退勤 (仕事量 $2 \times 9 = 18$)</li>
<li>社員 $3$ が時刻 $20 $ で出勤、時刻 $29$ で退勤 (仕事量 $2 \times 5 + 1 \times 4 = 14$)</li>
</ul>
<p>社員 $1, 2$ は仲が悪い者同士であるが、同時に勤務している時間は $1$ 単位時間未満であるので条件を満たしており、また仕事量の合計は $70 + 18 + 14 = 102 (\geq 100)$ となっている。$29 $ よりも短い時間での達成は不可能であるため、これが答えとなる。$i &lt; j$ ならば $s_i \leq s_j$ でなければならないことに注意せよ。</p>
<h3>入力例 2</h3>
<p><pre>
2 1 50
-3 -5 3
2 1 10
1 2 1
</pre></p>
<h3>出力例 2</h3>
<p><pre>
43
</pre></p>
<p>例えば以下のようにすれば達成可能である。</p>
<ul>
<li>社員 $1$ が時刻 $0$ で出勤、時刻 $1$ で退勤 (仕事量 $-3 \times 1 = -3$)</li>
<li>社員 $2$ が時刻 $0$ で出勤、時刻 $43$ で退勤 (仕事量 $2 \times 10 + 1 \times 33 = 53$)</li>
</ul>
<p>社員 $1, 2$ は仲が良い者同士であるため、同時に勤務している時間が $1$ 単位時間以上必要であることに注意せよ。</p>
<h3>入力例 3</h3>
<p><pre>
7 10 355
18 14 3
-10 -10 5
1 0 3
7 -10 8
4 1 8
100 5 3
-5 -7 1
1 7 1
2 3 -1
4 5 -1
6 7 1
3 7 1
5 6 -1
1 4 1
3 4 -1
1 2 1
5 7 -1
</pre></p>
<h3>出力例 3</h3>
<p><pre>
-1
</pre></p>
  </body>
</html>